sudo: required

language: bash

env:
    - FLAKE8=false
    - FLAKE8=true

install:
    # Dependencies
    - sudo apt-get -qq update
    - sudo pip install --upgrade -qq pip
    - sudo apt-get -qq install cdparanoia cdrdao flac gir1.2-glib-2.0 libcdio-dev libiso9660-dev libsndfile1-dev python-gi python-musicbrainzngs python-mutagen python-setuptools sox swig libcdio-utils
    - sudo pip install pycdio==0.21 requests setuptools_scm

    # Testing dependencies
    - sudo apt-get -qq install python-twisted-core
    - sudo pip install flake8

    # Build bundled C utils
    - cd src
    - sudo make install
    - cd ..

    # Installing
    - sudo python setup.py install

script:
    - if [ ! "$FLAKE8" = true ]; then python -m unittest discover; fi
    - if [ "$FLAKE8" = true ]; then flake8 --benchmark --statistics; fi
